{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "library(methods)\n",
    "library(ggplot2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "'201801_data'<-read.csv(\"/Users/jen/Downloads/201801_data.xlsx\", header=T, sep=\",\")\n",
    "'201802_data'<-read.csv(\"/Users/jen/Downloads/201802_data.xlsx\", header=T, sep=\",\")\n",
    "'201803_data'<-read.csv(\"/Users/jen/Downloads/201803_data.xlsx\", header=T, sep=\",\")\n",
    "'201804_data'<-read.csv(\"/Users/jen/Downloads/201804_data.xlsx\", header=T, sep=\",\")\n",
    "'201805_data'<-read.csv(\"/Users/jen/Downloads/201805_data.xlsx\", header=T, sep=\",\")\n",
    "'201806_data'<-read.csv(\"/Users/jen/Downloads/201806_data.xlsx\", header=T, sep=\",\")\n",
    "'201807_data'<-read.csv(\"/Users/jen/Downloads/201807_data.xlsx\", header=T, sep=\",\")\n",
    "'201808_data'<-read.csv(\"/Users/jen/Downloads/201808_data.xlsx\", header=T, sep=\",\")\n",
    "'201809_data'<-read.csv(\"/Users/jen/Downloads/201809_data.xlsx\", header=T, sep=\",\")\n",
    "'201810_data'<-read.csv(\"/Users/jen/Downloads/201810_data.xlsx\", header=T, sep=\",\")\n",
    "'201811_data'<-read.csv(\"/Users/jen/Downloads/201811_data.xlsx\", header=T, sep=\",\")\n",
    "'201812_data'<-read.csv(\"/Users/jen/Downloads/201812_data.xlsx\", header=T, sep=\",\")\n",
    "'201901_data'<-read.csv(\"/Users/jen/Downloads/201901_data.xlsx\", header=T, sep=\",\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#1.台北市長聲量比較圖\n",
    "#初始化變數\n",
    "counta<-c(rep.int(x=0,times = 12))\n",
    "countb<-c(rep.int(x=0,times = 12))\n",
    "countc<-c(rep.int(x=0,times = 12))\n",
    "#尋找2018中提及柯文哲的文章內容\n",
    "for (i in grep(\"柯\",`201801_data`$Message)) {\n",
    "  counta[1]=counta[1]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201802_data`$Message)) {\n",
    "  counta[2]=counta[2]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201803_data`$Message)) {\n",
    "  counta[3]=counta[3]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201804_data`$Message)) {\n",
    "  counta[4]=counta[4]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201805_data`$Message)) {\n",
    "  counta[5]=counta[5]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201806_data`$Message)) {\n",
    "  counta[6]=counta[6]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201807_data`$Message)) {\n",
    "  counta[7]=counta[7]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201808_data`$Message)) {\n",
    "  counta[8]=counta[8]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201809_data`$Message)) {\n",
    "  counta[9]=counta[9]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201810_data`$Message)) {\n",
    "  counta[10]=counta[10]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201811_data`$Message)) {\n",
    "  counta[11]=counta[11]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201812_data`$Message)) {\n",
    "  counta[12]=counta[12]+1\n",
    "}\n",
    "for (i in grep(\"柯\",`201901_data`$Message)) {\n",
    "  counta[13]=counta[13]+1\n",
    "}\n",
    "kp<-counta\n",
    "kp\n",
    "#尋找2018中提及姚文智的內容\n",
    "for (i in grep(\"姚\",`201801_data`$Message)) {\n",
    "  countb[1]=countb[1]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201802_data`$Message)) {\n",
    "  countb[2]=countb[2]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201803_data`$Message)) {\n",
    "  countb[3]=countb[3]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201804_data`$Message)) {\n",
    "  countb[4]=countb[4]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201805_data`$Message)) {\n",
    "  countb[5]=countb[5]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201806_data`$Message)) {\n",
    "  countb[6]=countb[6]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201807_data`$Message)) {\n",
    "  countb[7]=countb[7]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201808_data`$Message)) {\n",
    "  countb[8]=countb[8]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201809_data`$Message)) {\n",
    "  countb[9]=countb[9]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201810_data`$Message)) {\n",
    "  countb[10]=countb[10]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201811_data`$Message)) {\n",
    "  countb[11]=countb[11]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201812_data`$Message)) {\n",
    "  countb[12]=countb[12]+1\n",
    "}\n",
    "for (i in grep(\"姚\",`201901_data`$Message)) {\n",
    "  countb[13]=countb[13]+1\n",
    "}\n",
    "#尋找2018中提及丁守中的內容\n",
    "for (i in grep(\"丁\",`201801_data`$Message)) {\n",
    "  countc[1]=countc[1]+1\n",
    "}\n",
    "\n",
    "for (i in grep(\"丁\",`201802_data`$Message)) {\n",
    "  countc[2]=countc[2]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201803_data`$Message)) {\n",
    "  countc[3]=countc[3]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201804_data`$Message)) {\n",
    "  countc[4]=countc[4]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201805_data`$Message)) {\n",
    "  countc[5]=countc[5]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201806_data`$Message)) {\n",
    "  countc[6]=countc[6]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201807_data`$Message)) {\n",
    "  countc[7]=countc[7]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201808_data`$Message)) {\n",
    "  countc[8]=countc[8]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201809_data`$Message)) {\n",
    "  countc[9]=countc[9]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201810_data`$Message)) {\n",
    "  countc[10]=countc[10]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201811_data`$Message)) {\n",
    "  countc[11]=countc[11]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201812_data`$Message)) {\n",
    "  countc[12]=countc[12]+1\n",
    "}\n",
    "for (i in grep(\"丁\",`201901_data`$Message)) {\n",
    "  countc[13]=countc[13]+1\n",
    "}\n",
    "dd<-countc\n",
    "uu<-countb\n",
    "\n",
    "Month<-c(rep.int(1:13,3))\n",
    "tot<-c(kp,uu,dd)\n",
    "Candidate<-c(rep(\"kp\",13),rep(\"uu\",13),rep(\"dd\",13))\n",
    "#給定一個dataframe\n",
    "testfor1<- data.frame( \n",
    "  Month,Candidate,tot\n",
    ") \n",
    "print(testfor1) \n",
    "par(family = \"PingFangTC-Medium\") #嘗試指定中文字型（但失敗）\n",
    "system(\"defaults write org.R-project.R force.LANG zh_TW.UTF-8\")#嘗試使用中文第二次，失敗第二次\n",
    "#畫折線圖，使用ggplot2 package，放棄使用中文\n",
    "ggplot(testfor1,aes(x=Month,y=tot,color=Candidate,group=Candidate))+geom_line()+ggtitle(\"Taipei\")+xlab(\"Month\")+ylab(\"count\")+geom_point(size = 1)+\n",
    " xlim(1,12)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "##韓國瑜和陳其邁在大選期間的讚數和貼文數量比較\n",
    "sum_han=0;sum_ccm=0;sum_han2=0;sum_ccm2=0\n",
    "x1<-subset(`201801_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\"))\n",
    "x1<-rbind(x1,subset(`201802_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201803_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201804_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),\n",
    "      subset(`201805_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201806_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201807_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201808_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201809_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),\n",
    "      subset(`201810_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201811_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201812_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201901_data`,Page_Name==\"韓國瑜\",select =c(\"LIKE_COUNT\",\"Comment_Count\")))\n",
    "sum_han<-sum(as.numeric(x1$LIKE_COUNT))\n",
    "sum_han2<-sum(as.numeric(x1$Comment_Count))\n",
    "x2<-subset(`201801_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\"))\n",
    "x2<-rbind(x2,subset(`201802_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201802_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201803_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201804_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\"))\n",
    "          ,subset(`201805_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201806_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201807_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201808_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201809_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\"))\n",
    "          ,subset(`201810_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201811_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201812_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")),subset(`201901_data`,Page_Name==\"陳其邁 Chen Chi-Mai\",select =c(\"LIKE_COUNT\",\"Comment_Count\")))\n",
    "sum_ccm<-sum(as.numeric(x2$LIKE_COUNT))\n",
    "sum_ccm2<-sum(as.numeric(x2$Comment_Count))\n",
    "x1['person']='han'\n",
    "x2['person']='ccm'\n",
    "new_data1<-matrix(c(sum_ccm,sum_ccm2,sum_han,sum_han2),nrow=2,ncol=2,byrow = TRUE)\n",
    "new_data1<-prop.table(new_data1)\n",
    "rownames(new_data1)<-c(\"han\",\"ccm\")\n",
    "colnames(new_data1)<-c(\"like\",\"comment\")\n",
    "# Create the input vectors.\n",
    "colors = c(\"orange\",\"brown\")\n",
    "people<-c(\"han\",\"ccm\")\n",
    "types<-c(\"comment\",\"like\")\n",
    "# Create the bar chart\n",
    "barplot(new_data1,main=\"comparison between Kaoshiung\",names.arg = people,col = colors,ylab = \"count\")\n",
    "# Add the legend to the chart\n",
    "legend(\"topright\", types, cex = 0.8, fill = colors)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "##韓國瑜的表情貼趨勢\n",
    "s1<-sum(`201801_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201801_data`$Page_Name))])\n",
    "s2<-sum(`201802_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201802_data`$Page_Name))])\n",
    "s3<-sum(`201803_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201803_data`$Page_Name))])\n",
    "s3<-as.numeric(`201803_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201803_data`$Page_Name))])\n",
    "s3<-sum(s3)\n",
    "s4<-sum(`201804_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201804_data`$Page_Name))])\n",
    "s5<-as.numeric(`201805_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201805_data`$Page_Name))])\n",
    "s5<-sum(s5)\n",
    "s6<-sum(`201806_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201806_data`$Page_Name))])\n",
    "s7<-sum(`201807_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201807_data`$Page_Name))])\n",
    "s8<-sum(`201808_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201808_data`$Page_Name))])\n",
    "s9<-as.numeric(`201809_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201809_data`$Page_Name))])\n",
    "s9<-sum(s9)\n",
    "s10<-sum(`201810_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201810_data`$Page_Name))])\n",
    "s11<-sum(`201811_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201811_data`$Page_Name))])\n",
    "s12<-as.numeric(`201812_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201812_data`$Page_Name))])\n",
    "s12<-sum(s12)\n",
    "s13<-sum(`201901_data`$LIKE_COUNT[which(grepl(\"^韓國瑜$\",`201901_data`$Page_Name))])\n",
    "\n",
    "w1<-sum(`201801_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201801_data`$Page_Name))])\n",
    "w2<-sum(`201802_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201802_data`$Page_Name))])\n",
    "w3<-as.numeric(`201803_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201803_data`$Page_Name))])\n",
    "w3<-sum(w3)\n",
    "w4<-sum(`201804_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201804_data`$Page_Name))])\n",
    "w5<-as.numeric(`201805_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201805_data`$Page_Name))])\n",
    "w5<-sum(w5)\n",
    "w6<-sum(`201806_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201806_data`$Page_Name))])\n",
    "w7<-sum(`201807_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201807_data`$Page_Name))])\n",
    "w8<-sum(`201808_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201808_data`$Page_Name))])\n",
    "w9<-as.numeric(`201809_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201809_data`$Page_Name))])\n",
    "w9<-sum(w9)\n",
    "w10<-sum(`201810_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201810_data`$Page_Name))])\n",
    "w11<-sum(`201811_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201811_data`$Page_Name))])\n",
    "w12<-as.numeric(`201812_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201812_data`$Page_Name))])\n",
    "w12<-sum(w12)\n",
    "w13<-0\n",
    "\n",
    "l1<-sum(`201801_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201801_data`$Page_Name))])\n",
    "l2<-sum(`201802_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201802_data`$Page_Name))])\n",
    "l3<-as.numeric(`201803_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201803_data`$Page_Name))])\n",
    "l3<-sum(w3)\n",
    "l4<-sum(`201804_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201804_data`$Page_Name))])\n",
    "l5<-as.numeric(`201805_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201805_data`$Page_Name))])\n",
    "l5<-sum(l5)\n",
    "l6<-sum(`201806_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201806_data`$Page_Name))])\n",
    "l7<-sum(`201807_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201807_data`$Page_Name))])\n",
    "l8<-sum(`201808_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201808_data`$Page_Name))])\n",
    "l9<-as.numeric(`201809_data`$WOW_COUNT[which(grepl(\"^韓國瑜$\",`201809_data`$Page_Name))])\n",
    "l9<-sum(l9)\n",
    "l10<-sum(`201810_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201810_data`$Page_Name))])\n",
    "l11<-sum(`201811_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201811_data`$Page_Name))])\n",
    "l12<-as.numeric(`201812_data`$LOVE_COUNT[which(grepl(\"^韓國瑜$\",`201812_data`$Page_Name))])\n",
    "l12<-sum(l12)\n",
    "l13<-0\n",
    "\n",
    "like_han<-data.frame(month=c(1:12,13),count=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,w1,w2,w3,w4,w5,w6,w7,w8,w9,w10,w11,w12,w13,l1,l2,l3,l4,l5,l6,l7,l8,l9,l10,l11,l12,l13),\n",
    "                     types=c('like','like','like','like','like','like','like','like','like','like','like','like','like','wow','wow','wow','wow','wow','wow','wow','wow','wow','wow','wow','wow','wow','love','love','love','love','love','love','love','love','love','love','love','love','love'))\n",
    "\n",
    "p1 <- ggplot(like_han, aes(x =month, y =count,colour=types))+ geom_line()+ scale_colour_brewer(palette = \"Set2\")\n",
    "p1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "##陳其邁的表情圖趨勢\n",
    "s1<-sum(`201801_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201801_data`$Page_Name))])\n",
    "s2<-sum(`201802_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201802_data`$Page_Name))])\n",
    "s3<-sum(`201803_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201803_data`$Page_Name))])\n",
    "s3<-as.numeric(`201803_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201803_data`$Page_Name))])\n",
    "s3<-sum(s3)\n",
    "s4<-sum(`201804_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201804_data`$Page_Name))])\n",
    "s5<-as.numeric(`201805_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201805_data`$Page_Name))])\n",
    "s5<-sum(s5)\n",
    "s6<-sum(`201806_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201806_data`$Page_Name))])\n",
    "s7<-sum(`201807_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201807_data`$Page_Name))])\n",
    "s8<-sum(`201808_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201808_data`$Page_Name))])\n",
    "s9<-as.numeric(`201809_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201809_data`$Page_Name))])\n",
    "s9<-sum(s9)\n",
    "s10<-sum(`201810_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201810_data`$Page_Name))])\n",
    "s11<-sum(`201811_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201811_data`$Page_Name))])\n",
    "s12<-as.numeric(`201812_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201812_data`$Page_Name))])\n",
    "s12<-sum(s12)\n",
    "s13<-sum(`201901_data`$LIKE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201901_data`$Page_Name))])\n",
    "\n",
    "w1<-sum(`201801_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201801_data`$Page_Name))])\n",
    "w2<-sum(`201802_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201802_data`$Page_Name))])\n",
    "w3<-as.numeric(`201803_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201803_data`$Page_Name))])\n",
    "w3<-sum(w3)\n",
    "w4<-sum(`201804_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201804_data`$Page_Name))])\n",
    "w5<-as.numeric(`201805_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201805_data`$Page_Name))])\n",
    "w5<-sum(w5)\n",
    "w6<-sum(`201806_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201806_data`$Page_Name))])\n",
    "w7<-sum(`201807_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201807_data`$Page_Name))])\n",
    "w8<-sum(`201808_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201808_data`$Page_Name))])\n",
    "w9<-as.numeric(`201809_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201809_data`$Page_Name))])\n",
    "w9<-sum(w9)\n",
    "w10<-sum(`201810_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201810_data`$Page_Name))])\n",
    "w11<-sum(`201811_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201811_data`$Page_Name))])\n",
    "w12<-as.numeric(`201812_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201812_data`$Page_Name))])\n",
    "w12<-sum(w12)\n",
    "w13<-0\n",
    "\n",
    "l1<-sum(`201801_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201801_data`$Page_Name))])\n",
    "l2<-sum(`201802_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201802_data`$Page_Name))])\n",
    "l3<-as.numeric(`201803_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201803_data`$Page_Name))])\n",
    "l3<-sum(w3)\n",
    "l4<-sum(`201804_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201804_data`$Page_Name))])\n",
    "l5<-as.numeric(`201805_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201805_data`$Page_Name))])\n",
    "l5<-sum(l5)\n",
    "l6<-sum(`201806_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201806_data`$Page_Name))])\n",
    "l7<-sum(`201807_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201807_data`$Page_Name))])\n",
    "l8<-sum(`201808_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201808_data`$Page_Name))])\n",
    "l9<-as.numeric(`201809_data`$WOW_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201809_data`$Page_Name))])\n",
    "l9<-sum(l9)\n",
    "l10<-sum(`201810_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201810_data`$Page_Name))])\n",
    "l11<-sum(`201811_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201811_data`$Page_Name))])\n",
    "l12<-as.numeric(`201812_data`$LOVE_COUNT[which(grepl(\"^陳其邁 Chen Chi-Mai$\",`201812_data`$Page_Name))])\n",
    "l12<-sum(l12)\n",
    "l13<-0\n",
    "\n",
    "like_han<-data.frame(month=c(1:12,13),count=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,w1,w2,w3,w4,w5,w6,w7,w8,w9,w10,w11,w12,w13,l1,l2,l3,l4,l5,l6,l7,l8,l9,l10,l11,l12,l13),\n",
    "                     types=c('like','like','like','like','like','like','like','like','like','like','like','like','like','wow','wow','wow','wow','wow','wow','wow','wow','wow','wow','wow','wow','wow','love','love','love','love','love','love','love','love','love','love','love','love','love'))\n",
    "\n",
    "p1 <- ggplot(like_han, aes(x =month, y =count,colour=types))+ geom_line()+ scale_colour_brewer(palette = \"Set1\")\n",
    "p1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "'201811_data'<-read.csv(\"/Users/jen/Downloads/201811_data.xlsx\", header=T, sep=\",\")\n",
    "library(readr)\n",
    "tt<-levels(`201811_data`$Type)\n",
    "data11<-subset(`201811_data`,grepl(\"柯文哲\", `201811_data`$Page_Name) == TRUE)\n",
    "ab1<-filter(`data11`,`data11`$Type==tt[1])\n",
    "ab2<-filter(`data11`,`data11`$Type==tt[2])\n",
    "ab3<-filter(`data11`,`data11`$Type==tt[3])\n",
    "ab4<-filter(`data11`,`data11`$Type==tt[4])\n",
    "ab5<-filter(`data11`,`data11`$Type==tt[5])\n",
    "ab<-data.frame(x=c(nrow(ab1),nrow(ab2),nrow(ab3),nrow(ab4),nrow(ab5)))\n",
    "pie(ab$x, labels = c(tt))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "library(tidyverse)\n",
    "VideoMatrix <- subset(`201811_data`,`201811_data`$Type == \"video\")\n",
    "kvideo = subset(VideoMatrix,grepl(\"柯文哲\", VideoMatrix$Page_Name) == TRUE)\n",
    "tvideo = subset(VideoMatrix,grepl(\"丁守中\", VideoMatrix$Page_Name) == TRUE)\n",
    "\n",
    "kcomment = kvideo[,c(2,13,15)]\n",
    "tcomment = tvideo[,c(2,13,15)]\n",
    "ktComment = rbind(kcomment, tcomment)\n",
    "\n",
    "library(kableExtra)\n",
    "\n",
    "library(ggplot2)\n",
    "\n",
    "\n",
    "ktmessage = ktComment %>% group_by(Page_Name) %>% \n",
    "  mutate(messageByName = paste0(Message, collapse = \"\"))\n",
    "\n",
    "id = which(duplicated(ktmessage$Page_Name) == FALSE)\n",
    "\n",
    "ktmessageAll = ktmessage[id,c(1,4)]\n",
    "\n",
    "\n",
    "library(jiebaRD)\n",
    "library(jiebaR)\n",
    "\n",
    "cutter <- worker(\"tag\")\n",
    "\n",
    "# 自建字典\n",
    "dic = c(\"柯文哲\", \"柯p\", \"台北人\")\n",
    "new_user_word(cutter, dic)#將柯文哲、柯ｐ、台北人作為分詞依據\n",
    "\n",
    "myFUN<- function(str) {\n",
    "  str = gsub(\"[A-Za-z0-9]\", \"\", str)\n",
    "  seg = cutter[str]\n",
    "  id = which(nchar(seg) > 1)\n",
    "  result = seg[id]\n",
    "}#自訂函數，切割發文內容\n",
    "\n",
    "segment = apply(matrix(ktmessageAll$messageByName), 1, myFUN)#將發文內容apply function myFUN\n",
    "\n",
    "R = table(segment[[1]])\n",
    "L = table(segment[[2]])\n",
    "M_R = merge(x = R, y = L, by = \"Var1\", all = TRUE)\n",
    "DTM_H = merge(x = M_R, y = table(segment[[3]]), by = \"Var1\", all = TRUE)\n",
    "DTM_H[is.na(DTM_H)] <- 0\n",
    "rownames(DTM_H) = DTM_H$Var1\n",
    "DTM_H = DTM_H[,-1]\n",
    "library(topicmodels)\n",
    "dtm_lda <- LDA(t(DTM_H), k = 8, control = list(seed = 1234)) #模型設定\n",
    "library(tidytext)\n",
    "dtm_topics <- tidy(dtm_lda, matrix = \"beta\")\n",
    "library(magrittr)\n",
    "library(dplyr)\n",
    "\n",
    "\n",
    "top_terms <- dtm_topics %>%\n",
    "  group_by(topic) %>%\n",
    "  top_n(10, beta) %>%\n",
    "  ungroup() %>%\n",
    "  arrange(topic, -beta)\n",
    "\n",
    "top_terms %>%\n",
    "  mutate(term = reorder(term, beta)) %>%\n",
    "  ggplot(aes(term, beta, fill = factor(topic))) +\n",
    "  geom_col(show.legend = FALSE) +\n",
    "  facet_wrap(~ topic, scales = \"free\") +\n",
    "  coord_flip() +\n",
    "  theme(axis.text.y=element_text(colour=\"black\", family=\"Heiti TC Light\"))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "3.5.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
